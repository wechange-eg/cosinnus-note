{% extends "cosinnus_note/base.html" %}
{% load i18n cosinnus_tags widget_tweaks %}
{% block page_title %}{% trans "Notes" %}: {{group.name}} {% endblock %}

{% block breadcrumb %}
        {{ block.super }}
{% endblock %}

{% block leftnav %}
{% endblock leftnav %}


{% block content %}
    
    <!-- a box with semi transparent background -->
    <div class="content-box">
    
        {% include 'cosinnus/common/filter_controls.html' %}        
        
        {% if user|can_create_objects_in:group %}
        <form action="{% url 'cosinnus:note:add' group=group.slug %}" method="POST" id="note_create_form">{% csrf_token %}
	        <div class="app-main large-space">
	            <div type="button" class="btn btn-default w100">
	                <ul class="media-list">
	                    <li class="media">
	                        <a class="pull-left" href="{% url 'cosinnus:profile-detail' %}">
	                            {% include "cosinnus/user/user_avatar_image.html" with user=user %}
	                        </a>
	                        <div class="media-body no-horizontal-padding no-vertical-padding">
	                            {{ form.forms.obj.text.errors }}
		                        {% captureas placeholder %}{% trans "Schreibe einen Beitrag in diese Gruppe" %}{% endcaptureas %}
		                        {% render_field form.forms.obj.text class+="form-control next-button-is-for-sending autogrow oneline" placeholder=placeholder id="etherpadTitle" %}
	                        </div>
		                        
	                    </li>
	                </ul>
	            </div>
	            <div class="indented">
                   {% include 'cosinnus/media_tags.html' %}
                </div>
	            <button type="submit" class="btn btn-emphasized large-space" style="display: none;">
	                <ul class="media-list">
	                    <li class="media">
	                        <a class="pull-left" href="#">
	                            <i class="fa fa-pencil"></i>
	                        </a>
	                        <div class="media-body">
	                            {% trans "Create" %}
	                        </div>
	                    </li>
	                </ul>
	            </button>
	        </div>
        </form>
        {% endif %}
        
    
        {% for note in object_list %}
            <div class="large-space"> <!-- note-wrapper -->

                <div class="app-main">
                    <div type="button" class="btn btn-emphasized w100">
                        <ul class="media-list">
                            <li class="media">
                                <a class="pull-left" href="{{ note.creator.cosinnus_profile.get_absolute_url }}">
                                    {% include "cosinnus/user/user_avatar_image.html" with user=note.creator %}
                                </a>
                                <div class="media-body">
                                    <span class="annotation">
                                        <a href="{{ note.group.get_absolute_url }}">
                                            <i class="fa fa-users"></i>
                                            {{ note.group.name }}
                                        </a>
                                    </span>
                                    <strong><a href="{{ note.creator.cosinnus_profile.get_absolute_url }}">{{ note.creator|full_name }}</a></strong> <span class="moment-data-date" data-date="{{ note.created|date:'c' }}"></span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="indented">
                    {{ note.text|urlizetrunc:25|linebreaks }}
                    {% if note.attached_image %}
                        <img src="{{ note.attached_image.static_image_url }}" />
                    {% endif %}
                    {% if note.video %}
                        <a href="{{ note.video }}" target="_blank">
                            <img src="{{ note.video_thumbnail }}">
                        </a>
                    {% endif %}
                </div>
                
                {% include 'cosinnus/media_tags_readonly.html' with object=note list_view="True" %}

                <div class="app-calendar indented">
                    <button type="button" class="btn btn-emphasized w100">
                        <ul class="media-list fine-space">
                            <li class="media">
                                <a class="pull-left" href="#">
                                    <i class="fa fa-calendar"></i>
                                </a>
                                <a class="pull-right square-date-icon btn-extra-emphasized" href="#">
                                    <div>19</div>
                                    <div>Dez</div>
                                </a>
                                <div class="media-body">
                                            <strong><a>de:groth Call for Papers</a></strong>
                                </div>
                            </li>
                        </ul>
                    </button><!-- btn -->
                </div>

                {% include 'cosinnus_note/note_comments.html' with note=note full_view="True" comments_expanded="True" %}
                
            </div> <!-- note-wrapper -->
            
            
        {% empty %}
            {% include 'cosinnus/common/empty_button.html' with message="There are no notes." %}
        {% endfor %}
    
    </div><!-- content-box -->
{% endblock %}
